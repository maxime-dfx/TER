# --- MASTER MAKEFILE (CHEF D'ORCHESTRE) ---

# D√©finition des dossiers
DIR_FE = finite_elements
DIR_IMG = traitement_image
GNUPLOT_DIR = data/resultats/gnuplot

# Les cibles qui ne sont pas des fichiers
.PHONY: all clean fe img help

# 1. Commande par d√©faut (quand on tape juste "make")
all: fe img
	@echo "‚úÖ Tout est compil√© ! Les ex√©cutables sont dans le dossier 'bin'."

# 2. Compiler seulement la partie Elements Finis
fe:
	@echo "-----------------------------------"
	@echo "üîß Compilation du module Elements Finis..."
	@echo "-----------------------------------"
	@$(MAKE) -C $(DIR_FE)

# 3. Compiler seulement la partie Traitement Image
img:
	@echo "-----------------------------------"
	@echo "üì∏ Compilation du module Traitement Image..."
	@echo "-----------------------------------"
	@$(MAKE) -C $(DIR_IMG)

# 4. Tout nettoyer (supprimer les .o et les .exe)
clean:
	@echo "üßπ Nettoyage en cours..."
	@$(MAKE) -C $(DIR_FE) clean
	@$(MAKE) -C $(DIR_IMG) clean
	rm -rf bin/*
	@echo "‚ú® Tout est propre."

# 5. Aide
help:
	@echo "Commandes disponibles :"
	@echo "  make        : Compile tout le projet"
	@echo "  make fe     : Compile uniquement le solver √©l√©ments finis"
	@echo "  make img    : Compile uniquement le traitement d'image"
	@echo "  make clean  : Supprime tous les fichiers temporaires et ex√©cutables"

plot:
	@echo "G√©n√©ration des graphiques..."
	gnuplot $(GNUPLOT_DIR)/Heatmap.gp
	gnuplot $(GNUPLOT_DIR)/Poisson.gp
	gnuplot $(GNUPLOT_DIR)/Young.gp
	@echo "Graphiques g√©n√©r√©s dans data/resultats/graphique !"